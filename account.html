<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Account Settings - Momo Sushi</title>
  <link rel="stylesheet" href="account.css" />

</head>
<body>

  <!-- Navigation -->
  <nav class="top-nav">
    <div class="logo"><a href="index.html">Momo Sushi</a></div>
    <div class="nav-links">
      <a href="./menu.html">Menu</a>
      <a href="./reservations.html">Reserve</a>
      <a href="./reviews.html">Reviews</a>
      <a href="./contact.html">Contact</a>
      <a href="./aboutus.html">About</a>
      <a href="#" id="main-auth-link">Login</a>
      <div class="dropdown">
        <div class="menu-toggle">☰</div>
        <div class="dropdown-content">
          <a href="./profile.html" id="userProfileStatus">Not signed in</a>
          <a href="./menu.html">Menu</a>
          <a href="./menu.html">Order Now</a>
          <a href="./deals.html">Deals</a>
          <a href="./rewards.html">Rewards</a>
          <a href="./reservations.html">Reservation</a>
          <a href="./reviews.html">Reviews</a>
          <a href="./contact.html">Contact</a>
          <a href="./aboutus.html">About</a>
          <a href="#" id="dropdown-auth-link">Login</a>
        </div>
      </div>
    </div>
  </nav>

  <div class="account-container">
    <h2>Account Settings</h2>
    <label for="username">Username</label>
    <input type="text" id="username" placeholder="Enter new username" />

    <label for="email">Email</label>
    <input type="email" id="email" placeholder="Enter new email" />

    <label for="password">New Password</label>
    <input type="password" id="password" placeholder="Enter new password" />

    <button id="updateAccountBtn">Update Account</button>
  </div>

  <footer class="site-footer">
    <div class="footer-container">
      <div class="footer-logo">
        <a href="index.html">Momo Sushi</a>
      </div>
      <div class="footer-links">
        <a href="menu.html">Menu</a>
        <a href="reservations.html">Reserve</a>
        <a href="contact.html">Contact</a>
        <a href="reviews.html">Reviews</a>
        <a href="aboutus.html">About</a>
      </div>
      <p class="footer-note">© 2025 Momo Sushi · All rights reserved</p>
    </div>
  </footer>
  <script type="module">
    import { auth } from './FirebaseConfig.js';
    import {
      updateProfile,
      updateEmail,
      updatePassword,
      onAuthStateChanged,
      signOut
    } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-auth.js";

    const usernameInput = document.getElementById("username");
    const emailInput = document.getElementById("email");
    const passwordInput = document.getElementById("password");
    const updateBtn = document.getElementById("updateAccountBtn");

    onAuthStateChanged(auth, (user) => {
      const mainAuthLink = document.getElementById("main-auth-link");
      const dropdownAuthLink = document.getElementById("dropdown-auth-link");
      const profileLink = document.getElementById("userProfileStatus");

      if (user) {
        usernameInput.placeholder = user.displayName || "Enter new username";
        emailInput.placeholder = user.email || "Enter new email";

        mainAuthLink.textContent = "Logout";
        mainAuthLink.href = "#";
        mainAuthLink.onclick = handleLogout;

        dropdownAuthLink.textContent = "Logout";
        dropdownAuthLink.href = "#";
        dropdownAuthLink.onclick = handleLogout;

        profileLink.textContent = user.displayName || user.email;
        profileLink.href = "./account.html";
      } else {
        window.location.href = "./login.html";
      }
    });

    updateBtn.addEventListener("click", async () => {
      const user = auth.currentUser;
      if (!user) return;

      try {
        if (usernameInput.value.trim()) {
          await updateProfile(user, { displayName: usernameInput.value });
        }
        if (emailInput.value.trim()) {
          await updateEmail(user, emailInput.value);
        }
        if (passwordInput.value.trim()) {
          await updatePassword(user, passwordInput.value);
        }
        alert("Account updated successfully.");
      } catch (err) {
        console.error(err);
        alert("Error updating account: " + err.message);
      }
    });

    function handleLogout(e) {
      e.preventDefault();
      signOut(auth).then(() => {
        window.location.href = "login.html";
      });
    }
    window.handleLogout = handleLogout;
  </script>

<script>
    document.querySelector(".menu-toggle").addEventListener("click", function () {
document.querySelector(".dropdown").classList.toggle("active");
});

window.addEventListener("click", function (event) {
if (!event.target.closest(".dropdown")) {
document.querySelector(".dropdown").classList.remove("active");
}
});

</script>

</body>
</html>
